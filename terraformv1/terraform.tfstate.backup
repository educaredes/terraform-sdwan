{
  "version": 4,
  "terraform_version": "1.12.2",
  "serial": 1563,
  "lineage": "7798815c-a5b5-80bd-fdc7-094261341e45",
  "outputs": {},
  "resources": [
    {
      "mode": "managed",
      "type": "kubernetes_pod",
      "name": "vnf_access",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "index_key": "site1",
          "schema_version": 1,
          "attributes": {
            "id": "rdsv/vnf-access-site1",
            "metadata": [
              {
                "annotations": {
                  "cni.projectcalico.org/containerID": "c62b356fbcb44d5874d62568aa059c3207830ccdeed2b1ab082435d7e8e56904",
                  "cni.projectcalico.org/podIP": "10.1.138.57/32",
                  "cni.projectcalico.org/podIPs": "10.1.138.57/32",
                  "k8s.v1.cni.cncf.io/network-status": "[{\n    \"name\": \"k8s-pod-network\",\n    \"ips\": [\n        \"10.1.138.57\"\n    ],\n    \"default\": true,\n    \"dns\": {}\n},{\n    \"name\": \"rdsv/accessnet1\",\n    \"interface\": \"net1\",\n    \"mac\": \"12:01:6d:39:e2:d6\",\n    \"dns\": {}\n}]",
                  "k8s.v1.cni.cncf.io/networks": "[{\"interface\":\"net1\",\"name\":\"accessnet1\"}]"
                },
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "k8s-app": "vnf-access-site1"
                },
                "name": "vnf-access-site1",
                "namespace": "rdsv",
                "resource_version": "179267",
                "uid": "0e837024-06e8-48dc-934b-4a2b9cc96c87"
              }
            ],
            "spec": [
              {
                "active_deadline_seconds": 0,
                "affinity": [],
                "automount_service_account_token": true,
                "container": [
                  {
                    "args": null,
                    "command": [
                      "/bin/sh",
                      "-c",
                      " set -e -x\n /usr/share/openvswitch/scripts/ovs-ctl start\n while [ ! -e /var/run/openvswitch/db.sock ]; do\n   echo '‚è≥ Esperando OVS...'\n   sleep 1\n done\n\n while true; do\n   CPE_IP=$(getent hosts vnf-cpe-service-site1 | awk '{ print $1 }')\n   if [ ! -z \"$CPE_IP\" ]; then break; fi\n   echo \"‚è≥ Esperando IP de vnf-cpe...\"\n   sleep 2\n done\n\n SELF_IP=$(hostname -i)\n echo \"üåê IP local (access): $SELF_IP\"\n echo \"üéØ IP remota (cpe): $CPE_IP\"\n\n ip link del vxlan2 2\u003e/dev/null || true \n ip link del axscpe 2\u003e/dev/null || true \n\n ovs-vsctl add-br brint\n ip link set brint up\n ifconfig net1 10.255.0.1/24\n\n # VXLAN al cliente\n ip link add vxlan2 type vxlan id 2 remote 10.255.0.2 dstport 8742 dev net1\n\n # VXLAN al kNF:cpe\n ip link add axscpe type vxlan id 4 remote $CPE_IP dstport 8742 dev eth0\n\n ovs-vsctl add-port brint vxlan2\n ovs-vsctl add-port brint axscpe\n ip link set vxlan2 up\n ip link set axscpe up\n\n #########################################\n ###############  BRWAN  #################\n #########################################\n\n ovs-vsctl add-br brwan\n\n # VXLAN al cliente\n ip link add vxlan1 type vxlan id 1 remote 10.255.0.2 dstport 4789 dev net1\n\n # Esperar IP del vnf-wan\n while true; do\n WAN_IP=$(getent hosts vnf-wan-site1-pod | awk '{print $1}')\n   if [ ! -z \"$WAN_IP\" ]; then break; fi\n   echo \"‚è≥ Esperando IP de vnf-wan-site1...\"\n   sleep 2\n done\n\n# VXLAN al kNF:wan\n ip link add axswan type vxlan id 3 remote $WAN_IP dstport 4788 dev eth0\n\n ovs-vsctl add-port brwan vxlan1\n ovs-vsctl add-port brwan axswan\n\n ip link set vxlan1 up\n ip link set axswan up\n    \n\n sleep infinity\n"
                    ],
                    "env": [],
                    "env_from": [],
                    "image": "educaredes/vnf-access",
                    "image_pull_policy": "Always",
                    "lifecycle": [],
                    "liveness_probe": [],
                    "name": "vnf-access",
                    "port": [],
                    "readiness_probe": [],
                    "resources": [
                      {
                        "limits": {},
                        "requests": {}
                      }
                    ],
                    "security_context": [
                      {
                        "allow_privilege_escalation": true,
                        "capabilities": [
                          {
                            "add": [
                              "NET_ADMIN",
                              "SYS_ADMIN"
                            ],
                            "drop": null
                          }
                        ],
                        "privileged": true,
                        "read_only_root_filesystem": false,
                        "run_as_group": "",
                        "run_as_non_root": false,
                        "run_as_user": "",
                        "se_linux_options": [],
                        "seccomp_profile": []
                      }
                    ],
                    "startup_probe": [],
                    "stdin": false,
                    "stdin_once": false,
                    "termination_message_path": "/dev/termination-log",
                    "termination_message_policy": "File",
                    "tty": false,
                    "volume_device": [],
                    "volume_mount": [],
                    "working_dir": ""
                  }
                ],
                "dns_config": [],
                "dns_policy": "ClusterFirst",
                "enable_service_links": true,
                "host_aliases": [],
                "host_ipc": false,
                "host_network": false,
                "host_pid": false,
                "hostname": "",
                "image_pull_secrets": [],
                "init_container": [],
                "node_name": "vnxlab",
                "node_selector": null,
                "os": [],
                "priority_class_name": "",
                "readiness_gate": [],
                "restart_policy": "Always",
                "runtime_class_name": "",
                "scheduler_name": "default-scheduler",
                "security_context": [],
                "service_account_name": "default",
                "share_process_namespace": false,
                "subdomain": "",
                "termination_grace_period_seconds": 30,
                "toleration": [],
                "topology_spread_constraint": [],
                "volume": []
              }
            ],
            "target_state": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Pod",
            "name": "vnf-access-site1",
            "namespace": "rdsv"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0="
        },
        {
          "index_key": "site2",
          "schema_version": 1,
          "attributes": {
            "id": "rdsv/vnf-access-site2",
            "metadata": [
              {
                "annotations": {
                  "cni.projectcalico.org/containerID": "d9dfb0851bff6bcf16352ed4e2451c316acb246bea698d80152a98480d3fdc5b",
                  "cni.projectcalico.org/podIP": "10.1.138.54/32",
                  "cni.projectcalico.org/podIPs": "10.1.138.54/32",
                  "k8s.v1.cni.cncf.io/network-status": "[{\n    \"name\": \"k8s-pod-network\",\n    \"ips\": [\n        \"10.1.138.54\"\n    ],\n    \"default\": true,\n    \"dns\": {}\n},{\n    \"name\": \"rdsv/accessnet2\",\n    \"interface\": \"net2\",\n    \"mac\": \"4e:24:94:af:13:93\",\n    \"dns\": {}\n}]",
                  "k8s.v1.cni.cncf.io/networks": "[{\"interface\":\"net2\",\"name\":\"accessnet2\"}]"
                },
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "k8s-app": "vnf-access-site2"
                },
                "name": "vnf-access-site2",
                "namespace": "rdsv",
                "resource_version": "179263",
                "uid": "f6bf9ec5-62e9-4142-9ae0-acebddd003f9"
              }
            ],
            "spec": [
              {
                "active_deadline_seconds": 0,
                "affinity": [],
                "automount_service_account_token": true,
                "container": [
                  {
                    "args": null,
                    "command": [
                      "/bin/sh",
                      "-c",
                      " set -e -x\n /usr/share/openvswitch/scripts/ovs-ctl start\n while [ ! -e /var/run/openvswitch/db.sock ]; do\n   echo '‚è≥ Esperando OVS...'\n   sleep 1\n done\n\n while true; do\n   CPE_IP=$(getent hosts vnf-cpe-service-site2 | awk '{ print $1 }')\n   if [ ! -z \"$CPE_IP\" ]; then break; fi\n   echo \"‚è≥ Esperando IP de vnf-cpe...\"\n   sleep 2\n done\n\n SELF_IP=$(hostname -i)\n echo \"üåê IP local (access): $SELF_IP\"\n echo \"üéØ IP remota (cpe): $CPE_IP\"\n\n ip link del vxlan2 2\u003e/dev/null || true \n ip link del axscpe 2\u003e/dev/null || true \n\n ovs-vsctl add-br brint\n ip link set brint up\n ifconfig net2 10.255.0.1/24\n\n # VXLAN al cliente\n ip link add vxlan2 type vxlan id 2 remote 10.255.0.2 dstport 8742 dev net2\n\n # VXLAN al kNF:cpe\n ip link add axscpe type vxlan id 4 remote $CPE_IP dstport 8742 dev eth0\n\n ovs-vsctl add-port brint vxlan2\n ovs-vsctl add-port brint axscpe\n ip link set vxlan2 up\n ip link set axscpe up\n\n #########################################\n ###############  BRWAN  #################\n #########################################\n\n ovs-vsctl add-br brwan\n\n # VXLAN al cliente\n ip link add vxlan1 type vxlan id 1 remote 10.255.0.2 dstport 4789 dev net2\n\n # Esperar IP del vnf-wan\n while true; do\n WAN_IP=$(getent hosts vnf-wan-site2-pod | awk '{print $1}')\n   if [ ! -z \"$WAN_IP\" ]; then break; fi\n   echo \"‚è≥ Esperando IP de vnf-wan-site2...\"\n   sleep 2\n done\n\n# VXLAN al kNF:wan\n ip link add axswan type vxlan id 3 remote $WAN_IP dstport 4788 dev eth0\n\n ovs-vsctl add-port brwan vxlan1\n ovs-vsctl add-port brwan axswan\n\n ip link set vxlan1 up\n ip link set axswan up\n    \n\n sleep infinity\n"
                    ],
                    "env": [],
                    "env_from": [],
                    "image": "educaredes/vnf-access",
                    "image_pull_policy": "Always",
                    "lifecycle": [],
                    "liveness_probe": [],
                    "name": "vnf-access",
                    "port": [],
                    "readiness_probe": [],
                    "resources": [
                      {
                        "limits": {},
                        "requests": {}
                      }
                    ],
                    "security_context": [
                      {
                        "allow_privilege_escalation": true,
                        "capabilities": [
                          {
                            "add": [
                              "NET_ADMIN",
                              "SYS_ADMIN"
                            ],
                            "drop": null
                          }
                        ],
                        "privileged": true,
                        "read_only_root_filesystem": false,
                        "run_as_group": "",
                        "run_as_non_root": false,
                        "run_as_user": "",
                        "se_linux_options": [],
                        "seccomp_profile": []
                      }
                    ],
                    "startup_probe": [],
                    "stdin": false,
                    "stdin_once": false,
                    "termination_message_path": "/dev/termination-log",
                    "termination_message_policy": "File",
                    "tty": false,
                    "volume_device": [],
                    "volume_mount": [],
                    "working_dir": ""
                  }
                ],
                "dns_config": [],
                "dns_policy": "ClusterFirst",
                "enable_service_links": true,
                "host_aliases": [],
                "host_ipc": false,
                "host_network": false,
                "host_pid": false,
                "hostname": "",
                "image_pull_secrets": [],
                "init_container": [],
                "node_name": "vnxlab",
                "node_selector": null,
                "os": [],
                "priority_class_name": "",
                "readiness_gate": [],
                "restart_policy": "Always",
                "runtime_class_name": "",
                "scheduler_name": "default-scheduler",
                "security_context": [],
                "service_account_name": "default",
                "share_process_namespace": false,
                "subdomain": "",
                "termination_grace_period_seconds": 30,
                "toleration": [],
                "topology_spread_constraint": [],
                "volume": []
              }
            ],
            "target_state": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Pod",
            "name": "vnf-access-site2",
            "namespace": "rdsv"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "kubernetes_pod",
      "name": "vnf_cpe",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "index_key": "site1",
          "schema_version": 1,
          "attributes": {
            "id": "rdsv/vnf-cpe-site1",
            "metadata": [
              {
                "annotations": {
                  "cni.projectcalico.org/containerID": "4b3a4120e2749dd986cf1635fbaf81cb19251e31f73e6737e6256ffe20d97895",
                  "cni.projectcalico.org/podIP": "10.1.138.55/32",
                  "cni.projectcalico.org/podIPs": "10.1.138.55/32",
                  "k8s.v1.cni.cncf.io/network-status": "[{\n    \"name\": \"k8s-pod-network\",\n    \"ips\": [\n        \"10.1.138.55\"\n    ],\n    \"default\": true,\n    \"dns\": {}\n},{\n    \"name\": \"rdsv/extnet1\",\n    \"interface\": \"net1\",\n    \"mac\": \"c2:9a:7a:25:02:0e\",\n    \"dns\": {}\n}]",
                  "k8s.v1.cni.cncf.io/networks": "[{\"interface\":\"net1\",\"name\":\"extnet1\"}]"
                },
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "k8s-app": "vnf-cpe-site1"
                },
                "name": "vnf-cpe-site1",
                "namespace": "rdsv",
                "resource_version": "179244",
                "uid": "fcccc167-1851-4f53-aabf-4ae20a844e7b"
              }
            ],
            "spec": [
              {
                "active_deadline_seconds": 0,
                "affinity": [],
                "automount_service_account_token": true,
                "container": [
                  {
                    "args": null,
                    "command": [
                      "/bin/sh",
                      "-c",
                      "set -e -x\n/usr/share/openvswitch/scripts/ovs-ctl start\nwhile [ ! -e /var/run/openvswitch/db.sock ]; do echo '‚è≥ Esperando OVS‚Ä¶'; sleep 1; done\n\n################################ [1] Resolver ACCESS\nwhile true; do\n  ACCESS_IP=$(getent hosts vnf-access-site1-service | awk '{print $1}')\n  [ -n \"$ACCESS_IP\" ] \u0026\u0026 break\n  echo '‚è≥ Esperando IP de vnf-access‚Ä¶'; sleep 2\ndone\necho \"üåê CPE $(hostname -i) ‚Üí access $ACCESS_IP\"\n\n################################ [2] Resolver WAN antes de tocar rutas\nwhile true; do\n  WAN_IP=$(getent hosts vnf-wan-site1-pod | awk '{print $1}')\n  [ -n \"$WAN_IP\" ] \u0026\u0026 break\n  echo \"‚è≥ Esperando IP de vnf-wan-site1-pod‚Ä¶\"; sleep 2\ndone\necho \"üéØ WAN_IP=$WAN_IP\"\n\n################################ BRINT  (access ‚Üî cpe)\n# 1. Crear bridge OVS dentro del contenedor CPE\novs-vsctl add-br brint\n\n# 2. Asignar IP interna al bridge (LAN cliente)\nifconfig brint 192.168.255.254/24\n\n# 3. Crear t√∫nel VXLAN ID 4 hacia KNF:Access\nip link add axscpe type vxlan id 4 remote $ACCESS_IP dstport 8742 dev eth0 || true\novs-vsctl add-port brint axscpe\nifconfig axscpe up\n\n# 4. Ajustar MTU para evitar fragmentaci√≥n VXLAN\nifconfig brint mtu 1400\n\n# 5. Asignar IP p√∫blica al vCPE (interfaz netX)\nifconfig net1 10.100.1.1/24\n\n# 6. Rutas para poder alcanzar primero al Pod Access\nip route add $ACCESS_IP/32 via 169.254.1.1\n\n# 7. Ahora modificamos la ruta por defecto\nip route del 0.0.0.0/0 via 169.254.1.1\nip route add 0.0.0.0/0 via 10.100.1.254\n\n# 8. Ruta hacia la subred privada del cliente\nip route add 10.20.1.0/24 via 192.168.255.253\n\n################################  Interfaz p√∫blica + NAT\n/vnx_config_nat brint net1\n\n################################ [4] BRWAN   (cpe ‚Üî wan)\n# WAN_IP ya est√° resuelto. S√≥lo queda crear el bridge y t√∫neles.\nip route add $WAN_IP/32 via 169.254.1.1\novs-vsctl add-br brwan\nifconfig brwan mtu 1400          \nifconfig brwan up  \n\n# 1. Crear t√∫nel VXLAN ID 5 hacia vnf:wan              \nip link add cpewan type vxlan id 5 remote $WAN_IP dstport 8741 dev eth0\novs-vsctl add-port brwan cpewan\nifconfig cpewan up\n\n# VXLAN entre sites (sr1 ‚Üî sr2)\nip link add sr1sr2 type vxlan id 12 remote 10.100.2.1 dstport 8742 dev net1\novs-vsctl add-port brwan sr1sr2\nifconfig sr1sr2 up\n\nsleep infinity\n"
                    ],
                    "env": [],
                    "env_from": [],
                    "image": "educaredes/vnf-cpe",
                    "image_pull_policy": "Always",
                    "lifecycle": [],
                    "liveness_probe": [],
                    "name": "vnf-cpe",
                    "port": [],
                    "readiness_probe": [],
                    "resources": [
                      {
                        "limits": {},
                        "requests": {}
                      }
                    ],
                    "security_context": [
                      {
                        "allow_privilege_escalation": true,
                        "capabilities": [
                          {
                            "add": [
                              "NET_ADMIN",
                              "SYS_ADMIN"
                            ],
                            "drop": null
                          }
                        ],
                        "privileged": true,
                        "read_only_root_filesystem": false,
                        "run_as_group": "",
                        "run_as_non_root": false,
                        "run_as_user": "",
                        "se_linux_options": [],
                        "seccomp_profile": []
                      }
                    ],
                    "startup_probe": [],
                    "stdin": false,
                    "stdin_once": false,
                    "termination_message_path": "/dev/termination-log",
                    "termination_message_policy": "File",
                    "tty": false,
                    "volume_device": [],
                    "volume_mount": [],
                    "working_dir": ""
                  }
                ],
                "dns_config": [],
                "dns_policy": "ClusterFirst",
                "enable_service_links": true,
                "host_aliases": [],
                "host_ipc": false,
                "host_network": false,
                "host_pid": false,
                "hostname": "",
                "image_pull_secrets": [],
                "init_container": [],
                "node_name": "vnxlab",
                "node_selector": null,
                "os": [],
                "priority_class_name": "",
                "readiness_gate": [],
                "restart_policy": "Always",
                "runtime_class_name": "",
                "scheduler_name": "default-scheduler",
                "security_context": [],
                "service_account_name": "default",
                "share_process_namespace": false,
                "subdomain": "",
                "termination_grace_period_seconds": 30,
                "toleration": [],
                "topology_spread_constraint": [],
                "volume": []
              }
            ],
            "target_state": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Pod",
            "name": "vnf-cpe-site1",
            "namespace": "rdsv"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0="
        },
        {
          "index_key": "site2",
          "schema_version": 1,
          "attributes": {
            "id": "rdsv/vnf-cpe-site2",
            "metadata": [
              {
                "annotations": {
                  "cni.projectcalico.org/containerID": "46a3a4ffcf952a3b5f225cf25510a85fcaaf749b54b05bcab6c3ec39f60ae27a",
                  "cni.projectcalico.org/podIP": "10.1.138.56/32",
                  "cni.projectcalico.org/podIPs": "10.1.138.56/32",
                  "k8s.v1.cni.cncf.io/network-status": "[{\n    \"name\": \"k8s-pod-network\",\n    \"ips\": [\n        \"10.1.138.56\"\n    ],\n    \"default\": true,\n    \"dns\": {}\n},{\n    \"name\": \"rdsv/extnet2\",\n    \"interface\": \"net2\",\n    \"mac\": \"3a:a9:f5:d4:b5:91\",\n    \"dns\": {}\n}]",
                  "k8s.v1.cni.cncf.io/networks": "[{\"interface\":\"net2\",\"name\":\"extnet2\"}]"
                },
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "k8s-app": "vnf-cpe-site2"
                },
                "name": "vnf-cpe-site2",
                "namespace": "rdsv",
                "resource_version": "179256",
                "uid": "1b89127c-d73c-4fff-8452-0818451d3731"
              }
            ],
            "spec": [
              {
                "active_deadline_seconds": 0,
                "affinity": [],
                "automount_service_account_token": true,
                "container": [
                  {
                    "args": null,
                    "command": [
                      "/bin/sh",
                      "-c",
                      "set -e -x\n/usr/share/openvswitch/scripts/ovs-ctl start\nwhile [ ! -e /var/run/openvswitch/db.sock ]; do echo '‚è≥ Esperando OVS‚Ä¶'; sleep 1; done\n\n################################ [1] Resolver ACCESS\nwhile true; do\n  ACCESS_IP=$(getent hosts vnf-access-site2-service | awk '{print $1}')\n  [ -n \"$ACCESS_IP\" ] \u0026\u0026 break\n  echo '‚è≥ Esperando IP de vnf-access‚Ä¶'; sleep 2\ndone\necho \"üåê CPE $(hostname -i) ‚Üí access $ACCESS_IP\"\n\n################################ [2] Resolver WAN antes de tocar rutas\nwhile true; do\n  WAN_IP=$(getent hosts vnf-wan-site2-pod | awk '{print $1}')\n  [ -n \"$WAN_IP\" ] \u0026\u0026 break\n  echo \"‚è≥ Esperando IP de vnf-wan-site2-pod‚Ä¶\"; sleep 2\ndone\necho \"üéØ WAN_IP=$WAN_IP\"\n\n################################ BRINT  (access ‚Üî cpe)\n# 1. Crear bridge OVS dentro del contenedor CPE\novs-vsctl add-br brint\n\n# 2. Asignar IP interna al bridge (LAN cliente)\nifconfig brint 192.168.255.254/24\n\n# 3. Crear t√∫nel VXLAN ID 4 hacia KNF:Access\nip link add axscpe type vxlan id 4 remote $ACCESS_IP dstport 8742 dev eth0 || true\novs-vsctl add-port brint axscpe\nifconfig axscpe up\n\n# 4. Ajustar MTU para evitar fragmentaci√≥n VXLAN\nifconfig brint mtu 1400\n\n# 5. Asignar IP p√∫blica al vCPE (interfaz netX)\nifconfig net2 10.100.2.1/24\n\n# 6. Rutas para poder alcanzar primero al Pod Access\nip route add $ACCESS_IP/32 via 169.254.1.1\n\n# 7. Ahora modificamos la ruta por defecto\nip route del 0.0.0.0/0 via 169.254.1.1\nip route add 0.0.0.0/0 via 10.100.2.254\n\n# 8. Ruta hacia la subred privada del cliente\nip route add 10.20.2.0/24 via 192.168.255.253\n\n################################  Interfaz p√∫blica + NAT\n/vnx_config_nat brint net2\n\n################################ [4] BRWAN   (cpe ‚Üî wan)\n# WAN_IP ya est√° resuelto. S√≥lo queda crear el bridge y t√∫neles.\nip route add $WAN_IP/32 via 169.254.1.1\novs-vsctl add-br brwan\nifconfig brwan mtu 1400          \nifconfig brwan up  \n\n# 1. Crear t√∫nel VXLAN ID 5 hacia vnf:wan              \nip link add cpewan type vxlan id 5 remote $WAN_IP dstport 8741 dev eth0\novs-vsctl add-port brwan cpewan\nifconfig cpewan up\n\n# VXLAN entre sites (sr1 ‚Üî sr2)\nip link add sr1sr2 type vxlan id 12 remote 10.100.1.1 dstport 8742 dev net2\novs-vsctl add-port brwan sr1sr2\nifconfig sr1sr2 up\n\nsleep infinity\n"
                    ],
                    "env": [],
                    "env_from": [],
                    "image": "educaredes/vnf-cpe",
                    "image_pull_policy": "Always",
                    "lifecycle": [],
                    "liveness_probe": [],
                    "name": "vnf-cpe",
                    "port": [],
                    "readiness_probe": [],
                    "resources": [
                      {
                        "limits": {},
                        "requests": {}
                      }
                    ],
                    "security_context": [
                      {
                        "allow_privilege_escalation": true,
                        "capabilities": [
                          {
                            "add": [
                              "NET_ADMIN",
                              "SYS_ADMIN"
                            ],
                            "drop": null
                          }
                        ],
                        "privileged": true,
                        "read_only_root_filesystem": false,
                        "run_as_group": "",
                        "run_as_non_root": false,
                        "run_as_user": "",
                        "se_linux_options": [],
                        "seccomp_profile": []
                      }
                    ],
                    "startup_probe": [],
                    "stdin": false,
                    "stdin_once": false,
                    "termination_message_path": "/dev/termination-log",
                    "termination_message_policy": "File",
                    "tty": false,
                    "volume_device": [],
                    "volume_mount": [],
                    "working_dir": ""
                  }
                ],
                "dns_config": [],
                "dns_policy": "ClusterFirst",
                "enable_service_links": true,
                "host_aliases": [],
                "host_ipc": false,
                "host_network": false,
                "host_pid": false,
                "hostname": "",
                "image_pull_secrets": [],
                "init_container": [],
                "node_name": "vnxlab",
                "node_selector": null,
                "os": [],
                "priority_class_name": "",
                "readiness_gate": [],
                "restart_policy": "Always",
                "runtime_class_name": "",
                "scheduler_name": "default-scheduler",
                "security_context": [],
                "service_account_name": "default",
                "share_process_namespace": false,
                "subdomain": "",
                "termination_grace_period_seconds": 30,
                "toleration": [],
                "topology_spread_constraint": [],
                "volume": []
              }
            ],
            "target_state": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Pod",
            "name": "vnf-cpe-site2",
            "namespace": "rdsv"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "kubernetes_pod",
      "name": "vnf_wan",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "index_key": "site1",
          "schema_version": 1,
          "attributes": {
            "id": "rdsv/vnf-wan-site1",
            "metadata": [
              {
                "annotations": {
                  "cni.projectcalico.org/containerID": "93640e8502bb60f8c42898e5284001bd1867c64be03e1959b0d9c5aeae534fdf",
                  "cni.projectcalico.org/podIP": "10.1.138.58/32",
                  "cni.projectcalico.org/podIPs": "10.1.138.58/32",
                  "k8s.v1.cni.cncf.io/network-status": "[{\n    \"name\": \"k8s-pod-network\",\n    \"ips\": [\n        \"10.1.138.58\"\n    ],\n    \"default\": true,\n    \"dns\": {}\n},{\n    \"name\": \"rdsv/mplswan\",\n    \"interface\": \"net1\",\n    \"mac\": \"66:b3:d4:79:5e:2b\",\n    \"dns\": {}\n}]",
                  "k8s.v1.cni.cncf.io/networks": "[{\"interface\":\"net1\",\"name\":\"mplswan\"}]"
                },
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "k8s-app": "vnf-wan-site1"
                },
                "name": "vnf-wan-site1",
                "namespace": "rdsv",
                "resource_version": "179238",
                "uid": "13f95135-7f6b-4992-9adf-1bf6e025b345"
              }
            ],
            "spec": [
              {
                "active_deadline_seconds": 0,
                "affinity": [],
                "automount_service_account_token": true,
                "container": [
                  {
                    "args": null,
                    "command": [
                      "/bin/sh",
                      "-c",
                      "set -e -x\n/usr/share/openvswitch/scripts/ovs-ctl start\nwhile [ ! -e /var/run/openvswitch/db.sock ]; do\n  echo '‚è≥ Esperando OVS...'\n  sleep 1\ndone\n\n# Esperar IP del servicio vnf-access\nwhile true; do\n  ACCESS_IP=$(getent hosts vnf-access-site1-service | awk '{print $1}')\n  if [ -n \"$ACCESS_IP\" ]; then break; fi\n  echo \"‚è≥ Esperando IP de vnf-access-site1...\"\n  sleep 2\ndone\n\nSELF_IP=$(hostname -i)\necho \"üåê IP local (wan): $SELF_IP\"\necho \"üéØ IP remota (access): $ACCESS_IP\"\n\nip link del axswan 2\u003e/dev/null || true\n\n####################################################\n####################### BRWAN ######################\n####################################################\n# Esperar IP del CPE\nwhile true; do\n  CPE_IP=$(getent hosts vnf-cpe-service-site1 | awk '{ print $1 }')\n  if [ -n \"$CPE_IP\" ]; then break; fi\n  echo \"‚è≥ Esperando IP de vnf-cpe...\"\n  sleep 2\ndone\n\novs-vsctl add-br brwan\n\n#Crear t√∫nel VXLAN ID 3 hacia vnf:access \nip link add axswan type vxlan id 3 remote $ACCESS_IP dstport 4788 dev eth0\novs-vsctl add-port brwan axswan\novs-vsctl add-port brwan net1\n\nip link set axswan up\nip route del $ACCESS_IP via 169.254.1.1 dev eth0 2\u003e/dev/null || true\nip route add $ACCESS_IP via 169.254.1.1 dev eth0\n\nip link del cpewan 2\u003e/dev/null || true\n\n#Crear t√∫nel VXLAN ID 5 hacia vnf:cpe \nip link add cpewan type vxlan id 5 remote $CPE_IP dstport 8741 dev eth0\novs-vsctl add-port brwan cpewan\nifconfig cpewan up\n\n#####################\n####### RYU ########\n#####################\n\nryu-manager /root/flowmanager/flowmanager.py ryu.app.ofctl_rest \u003e /ryu.log 2\u003e\u00261 \u0026\n\novs-vsctl set bridge brwan protocols=OpenFlow10,OpenFlow12,OpenFlow13\novs-vsctl set-fail-mode brwan secure\novs-vsctl set bridge brwan other-config:datapath-id=0000000000000001\novs-vsctl set-controller brwan tcp:127.0.0.1:6633\n\n# Esperar a que el datapath aparezca en la API REST\nuntil curl -s http://127.0.0.1:8080/stats/switches | grep -q \"\\\\[1\\\\]\"; do\n  sleep 1\ndone\n\necho \"üì° Datapath activo. Carga las reglas SDN externamente con apply_flows.sh\"\n\n# Mantener el contenedor vivo\nsleep infinity\n"
                    ],
                    "env": [],
                    "env_from": [],
                    "image": "educaredes/vnf-wan",
                    "image_pull_policy": "Always",
                    "lifecycle": [],
                    "liveness_probe": [],
                    "name": "vnf-wan",
                    "port": [],
                    "readiness_probe": [],
                    "resources": [
                      {
                        "limits": {},
                        "requests": {}
                      }
                    ],
                    "security_context": [
                      {
                        "allow_privilege_escalation": true,
                        "capabilities": [
                          {
                            "add": [
                              "NET_ADMIN",
                              "SYS_ADMIN"
                            ],
                            "drop": null
                          }
                        ],
                        "privileged": true,
                        "read_only_root_filesystem": false,
                        "run_as_group": "",
                        "run_as_non_root": false,
                        "run_as_user": "",
                        "se_linux_options": [],
                        "seccomp_profile": []
                      }
                    ],
                    "startup_probe": [],
                    "stdin": false,
                    "stdin_once": false,
                    "termination_message_path": "/dev/termination-log",
                    "termination_message_policy": "File",
                    "tty": false,
                    "volume_device": [],
                    "volume_mount": [],
                    "working_dir": ""
                  }
                ],
                "dns_config": [],
                "dns_policy": "ClusterFirst",
                "enable_service_links": true,
                "host_aliases": [],
                "host_ipc": false,
                "host_network": false,
                "host_pid": false,
                "hostname": "",
                "image_pull_secrets": [],
                "init_container": [],
                "node_name": "vnxlab",
                "node_selector": null,
                "os": [],
                "priority_class_name": "",
                "readiness_gate": [],
                "restart_policy": "Always",
                "runtime_class_name": "",
                "scheduler_name": "default-scheduler",
                "security_context": [],
                "service_account_name": "default",
                "share_process_namespace": false,
                "subdomain": "",
                "termination_grace_period_seconds": 30,
                "toleration": [],
                "topology_spread_constraint": [],
                "volume": []
              }
            ],
            "target_state": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Pod",
            "name": "vnf-wan-site1",
            "namespace": "rdsv"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0="
        },
        {
          "index_key": "site2",
          "schema_version": 1,
          "attributes": {
            "id": "rdsv/vnf-wan-site2",
            "metadata": [
              {
                "annotations": {
                  "cni.projectcalico.org/containerID": "2a27295ce6adab312d27bd3c2f623d50449b19c4286c09191328f98d8d2422d9",
                  "cni.projectcalico.org/podIP": "10.1.138.62/32",
                  "cni.projectcalico.org/podIPs": "10.1.138.62/32",
                  "k8s.v1.cni.cncf.io/network-status": "[{\n    \"name\": \"k8s-pod-network\",\n    \"ips\": [\n        \"10.1.138.62\"\n    ],\n    \"default\": true,\n    \"dns\": {}\n},{\n    \"name\": \"rdsv/mplswan\",\n    \"interface\": \"net1\",\n    \"mac\": \"e6:76:b8:54:6f:c4\",\n    \"dns\": {}\n}]",
                  "k8s.v1.cni.cncf.io/networks": "[{\"interface\":\"net1\",\"name\":\"mplswan\"}]"
                },
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "k8s-app": "vnf-wan-site2"
                },
                "name": "vnf-wan-site2",
                "namespace": "rdsv",
                "resource_version": "179259",
                "uid": "ae25794d-557e-400b-bf4f-f6e78c0b88b8"
              }
            ],
            "spec": [
              {
                "active_deadline_seconds": 0,
                "affinity": [],
                "automount_service_account_token": true,
                "container": [
                  {
                    "args": null,
                    "command": [
                      "/bin/sh",
                      "-c",
                      "set -e -x\n/usr/share/openvswitch/scripts/ovs-ctl start\nwhile [ ! -e /var/run/openvswitch/db.sock ]; do\n  echo '‚è≥ Esperando OVS...'\n  sleep 1\ndone\n\n# Esperar IP del servicio vnf-access\nwhile true; do\n  ACCESS_IP=$(getent hosts vnf-access-site2-service | awk '{print $1}')\n  if [ -n \"$ACCESS_IP\" ]; then break; fi\n  echo \"‚è≥ Esperando IP de vnf-access-site2...\"\n  sleep 2\ndone\n\nSELF_IP=$(hostname -i)\necho \"üåê IP local (wan): $SELF_IP\"\necho \"üéØ IP remota (access): $ACCESS_IP\"\n\nip link del axswan 2\u003e/dev/null || true\n\n####################################################\n####################### BRWAN ######################\n####################################################\n# Esperar IP del CPE\nwhile true; do\n  CPE_IP=$(getent hosts vnf-cpe-service-site2 | awk '{ print $1 }')\n  if [ -n \"$CPE_IP\" ]; then break; fi\n  echo \"‚è≥ Esperando IP de vnf-cpe...\"\n  sleep 2\ndone\n\novs-vsctl add-br brwan\n\n#Crear t√∫nel VXLAN ID 3 hacia vnf:access \nip link add axswan type vxlan id 3 remote $ACCESS_IP dstport 4788 dev eth0\novs-vsctl add-port brwan axswan\novs-vsctl add-port brwan net1\n\nip link set axswan up\nip route del $ACCESS_IP via 169.254.1.1 dev eth0 2\u003e/dev/null || true\nip route add $ACCESS_IP via 169.254.1.1 dev eth0\n\nip link del cpewan 2\u003e/dev/null || true\n\n#Crear t√∫nel VXLAN ID 5 hacia vnf:cpe \nip link add cpewan type vxlan id 5 remote $CPE_IP dstport 8741 dev eth0\novs-vsctl add-port brwan cpewan\nifconfig cpewan up\n\n#####################\n####### RYU ########\n#####################\n\nryu-manager /root/flowmanager/flowmanager.py ryu.app.ofctl_rest \u003e /ryu.log 2\u003e\u00261 \u0026\n\novs-vsctl set bridge brwan protocols=OpenFlow10,OpenFlow12,OpenFlow13\novs-vsctl set-fail-mode brwan secure\novs-vsctl set bridge brwan other-config:datapath-id=0000000000000001\novs-vsctl set-controller brwan tcp:127.0.0.1:6633\n\n# Esperar a que el datapath aparezca en la API REST\nuntil curl -s http://127.0.0.1:8080/stats/switches | grep -q \"\\\\[1\\\\]\"; do\n  sleep 1\ndone\n\necho \"üì° Datapath activo. Carga las reglas SDN externamente con apply_flows.sh\"\n\n# Mantener el contenedor vivo\nsleep infinity\n"
                    ],
                    "env": [],
                    "env_from": [],
                    "image": "educaredes/vnf-wan",
                    "image_pull_policy": "Always",
                    "lifecycle": [],
                    "liveness_probe": [],
                    "name": "vnf-wan",
                    "port": [],
                    "readiness_probe": [],
                    "resources": [
                      {
                        "limits": {},
                        "requests": {}
                      }
                    ],
                    "security_context": [
                      {
                        "allow_privilege_escalation": true,
                        "capabilities": [
                          {
                            "add": [
                              "NET_ADMIN",
                              "SYS_ADMIN"
                            ],
                            "drop": null
                          }
                        ],
                        "privileged": true,
                        "read_only_root_filesystem": false,
                        "run_as_group": "",
                        "run_as_non_root": false,
                        "run_as_user": "",
                        "se_linux_options": [],
                        "seccomp_profile": []
                      }
                    ],
                    "startup_probe": [],
                    "stdin": false,
                    "stdin_once": false,
                    "termination_message_path": "/dev/termination-log",
                    "termination_message_policy": "File",
                    "tty": false,
                    "volume_device": [],
                    "volume_mount": [],
                    "working_dir": ""
                  }
                ],
                "dns_config": [],
                "dns_policy": "ClusterFirst",
                "enable_service_links": true,
                "host_aliases": [],
                "host_ipc": false,
                "host_network": false,
                "host_pid": false,
                "hostname": "",
                "image_pull_secrets": [],
                "init_container": [],
                "node_name": "vnxlab",
                "node_selector": null,
                "os": [],
                "priority_class_name": "",
                "readiness_gate": [],
                "restart_policy": "Always",
                "runtime_class_name": "",
                "scheduler_name": "default-scheduler",
                "security_context": [],
                "service_account_name": "default",
                "share_process_namespace": false,
                "subdomain": "",
                "termination_grace_period_seconds": 30,
                "toleration": [],
                "topology_spread_constraint": [],
                "volume": []
              }
            ],
            "target_state": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Pod",
            "name": "vnf-wan-site2",
            "namespace": "rdsv"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "kubernetes_service",
      "name": "vnf_access",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "index_key": "site1",
          "schema_version": 1,
          "attributes": {
            "id": "rdsv/vnf-access-site1-service",
            "metadata": [
              {
                "annotations": null,
                "generate_name": "",
                "generation": 0,
                "labels": null,
                "name": "vnf-access-site1-service",
                "namespace": "rdsv",
                "resource_version": "179125",
                "uid": "a2a1b729-495a-48b9-a299-159c1e3898d6"
              }
            ],
            "spec": [
              {
                "allocate_load_balancer_node_ports": true,
                "cluster_ip": "None",
                "cluster_ips": [
                  "None"
                ],
                "external_ips": null,
                "external_name": "",
                "external_traffic_policy": "",
                "health_check_node_port": 0,
                "internal_traffic_policy": "Cluster",
                "ip_families": [
                  "IPv4"
                ],
                "ip_family_policy": "SingleStack",
                "load_balancer_class": "",
                "load_balancer_ip": "",
                "load_balancer_source_ranges": null,
                "port": [],
                "publish_not_ready_addresses": false,
                "selector": {
                  "k8s-app": "vnf-access-site1"
                },
                "session_affinity": "None",
                "session_affinity_config": [],
                "type": "ClusterIP"
              }
            ],
            "status": [
              {
                "load_balancer": [
                  {
                    "ingress": []
                  }
                ]
              }
            ],
            "timeouts": null,
            "wait_for_load_balancer": true
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Service",
            "name": "vnf-access-site1-service",
            "namespace": "rdsv"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9LCJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="
        },
        {
          "index_key": "site2",
          "schema_version": 1,
          "attributes": {
            "id": "rdsv/vnf-access-site2-service",
            "metadata": [
              {
                "annotations": null,
                "generate_name": "",
                "generation": 0,
                "labels": null,
                "name": "vnf-access-site2-service",
                "namespace": "rdsv",
                "resource_version": "179124",
                "uid": "b0f3f0ab-d87d-4064-b089-b315c11feb9e"
              }
            ],
            "spec": [
              {
                "allocate_load_balancer_node_ports": true,
                "cluster_ip": "None",
                "cluster_ips": [
                  "None"
                ],
                "external_ips": null,
                "external_name": "",
                "external_traffic_policy": "",
                "health_check_node_port": 0,
                "internal_traffic_policy": "Cluster",
                "ip_families": [
                  "IPv4"
                ],
                "ip_family_policy": "SingleStack",
                "load_balancer_class": "",
                "load_balancer_ip": "",
                "load_balancer_source_ranges": null,
                "port": [],
                "publish_not_ready_addresses": false,
                "selector": {
                  "k8s-app": "vnf-access-site2"
                },
                "session_affinity": "None",
                "session_affinity_config": [],
                "type": "ClusterIP"
              }
            ],
            "status": [
              {
                "load_balancer": [
                  {
                    "ingress": []
                  }
                ]
              }
            ],
            "timeouts": null,
            "wait_for_load_balancer": true
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Service",
            "name": "vnf-access-site2-service",
            "namespace": "rdsv"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9LCJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "kubernetes_service",
      "name": "vnf_cpe",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "index_key": "site1",
          "schema_version": 1,
          "attributes": {
            "id": "rdsv/vnf-cpe-service-site1",
            "metadata": [
              {
                "annotations": null,
                "generate_name": "",
                "generation": 0,
                "labels": null,
                "name": "vnf-cpe-service-site1",
                "namespace": "rdsv",
                "resource_version": "179126",
                "uid": "a27f87db-cc09-4fed-94c7-aa819059d02c"
              }
            ],
            "spec": [
              {
                "allocate_load_balancer_node_ports": true,
                "cluster_ip": "None",
                "cluster_ips": [
                  "None"
                ],
                "external_ips": null,
                "external_name": "",
                "external_traffic_policy": "",
                "health_check_node_port": 0,
                "internal_traffic_policy": "Cluster",
                "ip_families": [
                  "IPv4"
                ],
                "ip_family_policy": "SingleStack",
                "load_balancer_class": "",
                "load_balancer_ip": "",
                "load_balancer_source_ranges": null,
                "port": [],
                "publish_not_ready_addresses": false,
                "selector": {
                  "k8s-app": "vnf-cpe-site1"
                },
                "session_affinity": "None",
                "session_affinity_config": [],
                "type": "ClusterIP"
              }
            ],
            "status": [
              {
                "load_balancer": [
                  {
                    "ingress": []
                  }
                ]
              }
            ],
            "timeouts": null,
            "wait_for_load_balancer": true
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Service",
            "name": "vnf-cpe-service-site1",
            "namespace": "rdsv"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9LCJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="
        },
        {
          "index_key": "site2",
          "schema_version": 1,
          "attributes": {
            "id": "rdsv/vnf-cpe-service-site2",
            "metadata": [
              {
                "annotations": null,
                "generate_name": "",
                "generation": 0,
                "labels": null,
                "name": "vnf-cpe-service-site2",
                "namespace": "rdsv",
                "resource_version": "179142",
                "uid": "2801c5e5-9be6-4964-9bc6-cf54a82cfa62"
              }
            ],
            "spec": [
              {
                "allocate_load_balancer_node_ports": true,
                "cluster_ip": "None",
                "cluster_ips": [
                  "None"
                ],
                "external_ips": null,
                "external_name": "",
                "external_traffic_policy": "",
                "health_check_node_port": 0,
                "internal_traffic_policy": "Cluster",
                "ip_families": [
                  "IPv4"
                ],
                "ip_family_policy": "SingleStack",
                "load_balancer_class": "",
                "load_balancer_ip": "",
                "load_balancer_source_ranges": null,
                "port": [],
                "publish_not_ready_addresses": false,
                "selector": {
                  "k8s-app": "vnf-cpe-site2"
                },
                "session_affinity": "None",
                "session_affinity_config": [],
                "type": "ClusterIP"
              }
            ],
            "status": [
              {
                "load_balancer": [
                  {
                    "ingress": []
                  }
                ]
              }
            ],
            "timeouts": null,
            "wait_for_load_balancer": true
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Service",
            "name": "vnf-cpe-service-site2",
            "namespace": "rdsv"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9LCJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "kubernetes_service",
      "name": "vnf_wan",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "index_key": "site1",
          "schema_version": 1,
          "attributes": {
            "id": "rdsv/vnf-wan-site1-service",
            "metadata": [
              {
                "annotations": null,
                "generate_name": "",
                "generation": 0,
                "labels": null,
                "name": "vnf-wan-site1-service",
                "namespace": "rdsv",
                "resource_version": "179151",
                "uid": "528f516e-1401-4013-945a-7a9fcc37a988"
              }
            ],
            "spec": [
              {
                "allocate_load_balancer_node_ports": true,
                "cluster_ip": "10.152.183.129",
                "cluster_ips": [
                  "10.152.183.129"
                ],
                "external_ips": null,
                "external_name": "",
                "external_traffic_policy": "Cluster",
                "health_check_node_port": 0,
                "internal_traffic_policy": "Cluster",
                "ip_families": [
                  "IPv4"
                ],
                "ip_family_policy": "SingleStack",
                "load_balancer_class": "",
                "load_balancer_ip": "",
                "load_balancer_source_ranges": null,
                "port": [
                  {
                    "app_protocol": "",
                    "name": "ryu-rest",
                    "node_port": 31880,
                    "port": 8080,
                    "protocol": "TCP",
                    "target_port": "8080"
                  }
                ],
                "publish_not_ready_addresses": false,
                "selector": {
                  "k8s-app": "vnf-wan-site1"
                },
                "session_affinity": "None",
                "session_affinity_config": [],
                "type": "NodePort"
              }
            ],
            "status": [
              {
                "load_balancer": [
                  {
                    "ingress": []
                  }
                ]
              }
            ],
            "timeouts": null,
            "wait_for_load_balancer": true
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Service",
            "name": "vnf-wan-site1-service",
            "namespace": "rdsv"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9LCJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="
        },
        {
          "index_key": "site2",
          "schema_version": 1,
          "attributes": {
            "id": "rdsv/vnf-wan-site2-service",
            "metadata": [
              {
                "annotations": null,
                "generate_name": "",
                "generation": 0,
                "labels": null,
                "name": "vnf-wan-site2-service",
                "namespace": "rdsv",
                "resource_version": "179166",
                "uid": "2809db57-8990-42c9-ac9d-70f5a6b87fc4"
              }
            ],
            "spec": [
              {
                "allocate_load_balancer_node_ports": true,
                "cluster_ip": "10.152.183.185",
                "cluster_ips": [
                  "10.152.183.185"
                ],
                "external_ips": null,
                "external_name": "",
                "external_traffic_policy": "Cluster",
                "health_check_node_port": 0,
                "internal_traffic_policy": "Cluster",
                "ip_families": [
                  "IPv4"
                ],
                "ip_family_policy": "SingleStack",
                "load_balancer_class": "",
                "load_balancer_ip": "",
                "load_balancer_source_ranges": null,
                "port": [
                  {
                    "app_protocol": "",
                    "name": "ryu-rest",
                    "node_port": 31881,
                    "port": 8080,
                    "protocol": "TCP",
                    "target_port": "8080"
                  }
                ],
                "publish_not_ready_addresses": false,
                "selector": {
                  "k8s-app": "vnf-wan-site2"
                },
                "session_affinity": "None",
                "session_affinity_config": [],
                "type": "NodePort"
              }
            ],
            "status": [
              {
                "load_balancer": [
                  {
                    "ingress": []
                  }
                ]
              }
            ],
            "timeouts": null,
            "wait_for_load_balancer": true
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Service",
            "name": "vnf-wan-site2-service",
            "namespace": "rdsv"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9LCJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "kubernetes_service",
      "name": "vnf_wan_pod",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "index_key": "site1",
          "schema_version": 1,
          "attributes": {
            "id": "rdsv/vnf-wan-site1-pod",
            "metadata": [
              {
                "annotations": null,
                "generate_name": "",
                "generation": 0,
                "labels": null,
                "name": "vnf-wan-site1-pod",
                "namespace": "rdsv",
                "resource_version": "179120",
                "uid": "53eb792a-29d5-443b-99b8-a5b1f22ada4d"
              }
            ],
            "spec": [
              {
                "allocate_load_balancer_node_ports": true,
                "cluster_ip": "None",
                "cluster_ips": [
                  "None"
                ],
                "external_ips": null,
                "external_name": "",
                "external_traffic_policy": "",
                "health_check_node_port": 0,
                "internal_traffic_policy": "Cluster",
                "ip_families": [
                  "IPv4"
                ],
                "ip_family_policy": "SingleStack",
                "load_balancer_class": "",
                "load_balancer_ip": "",
                "load_balancer_source_ranges": null,
                "port": [],
                "publish_not_ready_addresses": false,
                "selector": {
                  "k8s-app": "vnf-wan-site1"
                },
                "session_affinity": "None",
                "session_affinity_config": [],
                "type": "ClusterIP"
              }
            ],
            "status": [
              {
                "load_balancer": [
                  {
                    "ingress": []
                  }
                ]
              }
            ],
            "timeouts": null,
            "wait_for_load_balancer": true
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Service",
            "name": "vnf-wan-site1-pod",
            "namespace": "rdsv"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9LCJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="
        },
        {
          "index_key": "site2",
          "schema_version": 1,
          "attributes": {
            "id": "rdsv/vnf-wan-site2-pod",
            "metadata": [
              {
                "annotations": null,
                "generate_name": "",
                "generation": 0,
                "labels": null,
                "name": "vnf-wan-site2-pod",
                "namespace": "rdsv",
                "resource_version": "179121",
                "uid": "6a1f64fa-2566-4a9c-ab86-97bdc5bc0ca8"
              }
            ],
            "spec": [
              {
                "allocate_load_balancer_node_ports": true,
                "cluster_ip": "None",
                "cluster_ips": [
                  "None"
                ],
                "external_ips": null,
                "external_name": "",
                "external_traffic_policy": "",
                "health_check_node_port": 0,
                "internal_traffic_policy": "Cluster",
                "ip_families": [
                  "IPv4"
                ],
                "ip_family_policy": "SingleStack",
                "load_balancer_class": "",
                "load_balancer_ip": "",
                "load_balancer_source_ranges": null,
                "port": [],
                "publish_not_ready_addresses": false,
                "selector": {
                  "k8s-app": "vnf-wan-site2"
                },
                "session_affinity": "None",
                "session_affinity_config": [],
                "type": "ClusterIP"
              }
            ],
            "status": [
              {
                "load_balancer": [
                  {
                    "ingress": []
                  }
                ]
              }
            ],
            "timeouts": null,
            "wait_for_load_balancer": true
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Service",
            "name": "vnf-wan-site2-pod",
            "namespace": "rdsv"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9LCJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="
        }
      ]
    }
  ],
  "check_results": null
}
